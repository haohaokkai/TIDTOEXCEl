# TIDtoExcel 使用说明

## 快速开始

### 启动程序
```bash
# 方式1：双击批处理文件
启动数据记录软件.bat

# 方式2：命令行启动
python data_recorder.py
```

### 界面概览
- **设备配置区**：RFID端口和摄像头设置
- **数据输入区**：厂家名称、TID、标签号和图片
- **预览区域**：图片预览和摄像头画面
- **数据管理区**：数据列表和批量操作
- **导出功能**：Excel文件创建和导出

## 操作流程

### 1. 设备配置
**RFID设备配置**
- 选择RFID设备串口
- 点击"刷新"检测可用端口
- 配置自动保存

**摄像头配置**
- 选择摄像头设备
- 点击"刷新"检测可用摄像头
- 实时显示连接状态

### 2. 数据准备
**基础信息**
- 输入厂家名称（必填）
- 选择图片文件或使用摄像头捕获
- 支持格式：PNG、JPG、JPEG、GIF、BMP

**图片获取方式**
- **手动选择**：点击"选择图片"按钮
- **摄像头捕获**：点击"摄像头捕获"按钮
- **自动捕获**：自动获取模式下自动捕获

### 3. 自动获取模式（推荐）
**启动自动获取**
1. 点击"开始自动获取"按钮
2. 系统进入自动监控模式

**自动化流程**
- ✅ 自动读取RFID标签TID（连续5次验证）
- ✅ 自动OCR识别7位标签号
- ✅ 自动捕获摄像头图片
- ✅ 自动去重并添加到数据列表
- ✅ 持续监控，更换标签后自动获取

**停止获取**
- 点击"停止自动获取"按钮

### 4. 手动获取模式
**单步操作**
- 点击"自动获取TID"：读取当前标签TID
- 点击"自动获取标签号"：OCR识别标签号
- 点击"保存数据"：手动保存当前数据

### 5. 数据管理
**数据列表操作**
- **查看数据**：列表显示所有已获取数据
- **编辑数据**：双击数据行进行编辑
- **删除数据**：选中后点击"删除选中"
- **清空列表**：点击"清空列表"删除所有数据

**数据字段**
- 序号、厂家名称、TID、标签号、图片来源、获取时间

### 6. Excel导出
**导出选项**
- **新建Excel文件**：创建新的Excel文件
- **选择现有文件**：追加到现有Excel文件

**导出内容**
- 所有数据批量写入Excel
- 图片直接嵌入单元格（非文件路径）
- 自动调整图片大小和格式

**导出后操作**
- 可选择清空数据列表
- 继续录入新数据

## 功能特点

### Excel文件结构
| 列名 | 说明 |
|------|------|
| 序号 | 自动生成的序号 |
| 厂家名称 | 用户输入的厂家名称 |
| TID | RFID标签设备标识符 |
| 标签号 | OCR识别的7位标签号 |
| 图片 | 嵌入的实际图片对象 |
| 记录时间 | 数据保存的时间戳 |

### 图片处理特性
- 支持多种图片格式
- 自动调整图片大小适应Excel
- 图片以对象形式嵌入，不依赖外部文件
- 实时预览功能

### 数据验证和去重
- 所有字段必填验证
- 自动检测重复TID，避免重复录入
- 数据完整性检查

## 附加工具

### SVG Logo裁剪工具
**快速使用**
```bash
# 批处理工具（推荐）
双击 "裁剪SVG工具.bat"

# 命令行工具
python crop_svg_simple.py [左] [上] [右] [下]

# 交互式工具
python crop_svg_logo.py
```

**常用预设**
- 保留左侧30%：`0 0 30 100`
- 保留左侧50%：`0 0 50 100`
- 保留右侧50%：`50 0 100 100`
- 保留上半部分：`0 0 100 50`
- 保留中心区域：`25 25 75 75`

**参数说明**
- 左边界：0-100，从左侧开始的百分比
- 上边界：0-100，从顶部开始的百分比
- 右边界：0-100，到右侧结束的百分比
- 下边界：0-100，到底部结束的百分比

## 注意事项

### 使用前准备
- ✅ Python 3.7+ 已安装
- ✅ 依赖包已安装（`pip install -r requirements.txt`）
- ✅ RFID设备已连接
- ✅ 摄像头设备可用

### 使用中注意
- **文件权限**：确保对Excel文件有写入权限
- **文件占用**：保存时确保Excel文件未被其他程序打开
- **设备连接**：确保RFID和摄像头设备正常连接
- **网络环境**：首次使用OCR功能需要下载模型文件

### 性能优化建议
- 关闭不必要的后台程序
- 确保足够的内存空间（推荐2GB+）
- 使用SSD硬盘提升文件读写速度
- 定期清理临时文件

## 故障排除

### 程序启动问题
**问题**：程序无法启动
**解决方案**：
1. 检查Python版本：`python --version`
2. 安装依赖包：`pip install -r requirements.txt`
3. 检查系统权限和防火墙设置

### RFID设备问题
**问题**：无法读取RFID标签
**解决方案**：
1. 检查设备连接和驱动程序
2. 尝试不同的串口设置
3. 确认设备电源和天线连接
4. 检查标签是否在读取范围内

### 摄像头问题
**问题**：摄像头无法工作
**解决方案**：
1. 检查摄像头权限设置
2. 确认摄像头未被其他程序占用
3. 尝试切换不同的摄像头索引
4. 重启摄像头服务

### OCR识别问题
**问题**：标签号识别不准确
**解决方案**：
1. 调整摄像头角度和距离
2. 确保标签清晰可见
3. 改善光照条件
4. 增加OCR识别次数

### Excel导出问题
**问题**：无法导出到Excel
**解决方案**：
1. 确保Excel文件未被占用
2. 检查文件路径和权限
3. 验证所有必填字段已填写
4. 尝试创建新的Excel文件

## 示例操作

### 测试数据录入
使用程序自带的示例图片进行测试：

1. 启动程序
2. 配置RFID端口和摄像头
3. 输入测试数据：
   - 厂家名称：`示例厂家`
   - TID：`SAMPLE123456`
   - 标签号：`LABEL001`
4. 选择 `images/sample_device.png`
5. 点击"保存数据"
6. 导出到Excel验证功能

### 批量录入建议
1. **准备工作**：整理好所有图片文件，规范命名
2. **连续录入**：保持程序打开，使用自动获取模式
3. **定期保存**：每录入一定数量后导出到Excel
4. **数据备份**：定期备份Excel文件和配置

## 技术支持

### 配置文件位置
- 主配置：`config/config.json`
- 日志输出：控制台实时显示
- 临时文件：程序自动清理

### 常用配置参数
```json
{
  "rfid_port": "COM3",        // RFID设备串口
  "camera_index": 0,          // 摄像头索引
  "ocr_count": 10,           // OCR识别次数
  "tid_count": 5             // TID验证次数
}
```

### 获取帮助
如遇到问题，请：
1. 查看控制台错误信息
2. 检查配置文件设置
3. 参考README.md技术文档
4. 提交Issue或联系技术支持

---

**提示**：建议首次使用时先进行测试录入，熟悉操作流程后再进行批量数据录入。