# 数据记录软件使用说明

## 快速开始

### 1. 启动程序
双击 `启动数据记录软件.bat` 文件，或者在命令行中运行：
```bash
python data_recorder.py
```

### 2. 界面介绍
程序界面分为三个主要区域：
- **Excel文件管理区域**：用于创建或选择Excel文件
- **数据输入区域**：用于输入厂家名称、TID、标签号和选择图片
- **图片预览区域**：显示选择的图片预览

## 详细操作步骤

### 第一步：设备配置
1. **RFID端口配置**：
   - 从下拉列表中选择RFID设备的串口
   - 点击"刷新"按钮重新检测可用串口
   - 选择后自动保存到配置文件

2. **摄像头配置**：
   - 从下拉列表中选择要使用的摄像头
   - 点击"刷新"按钮重新检测可用摄像头
   - 选择后自动保存到配置文件

3. **配置状态**：界面会显示当前配置状态和保存结果

### 第二步：准备数据输入
1. **厂家名称**：在文本框中输入厂家名称（必填）
2. **图片**：可选择图片文件或使用摄像头捕获
   - 点击"选择图片"按钮选择现有图片文件
   - 点击"摄像头捕获"按钮从摄像头获取图片
   - 支持PNG、JPG、JPEG、GIF、BMP格式
   - 如果不选择图片，自动获取时将自动捕获摄像头图片

### 第三步：自动获取数据
1. **开始自动获取**：点击"开始自动获取"按钮
2. **自动化流程**：
   - 自动读取RFID标签的TID（需要连续5次相同读取）
   - 自动识别7位标签号（通过OCR摄像头识别）
   - 自动捕获摄像头图片（如果未手动选择图片）
   - 自动去重并添加到数据列表
3. **持续运行**：程序会持续运行，每次更换标签后自动获取新数据
4. **停止获取**：点击"停止自动获取"按钮结束自动获取

### 第四步：数据管理和导出
1. **查看数据列表**：所有获取的数据显示在列表中，包含：
   - 序号、厂家名称、TID、标签号、图片来源、获取时间
2. **批量操作**：
   - **清空列表**：清除所有数据
   - **删除选中**：删除选中的数据行
3. **导出到Excel**：
   - 点击"导出到Excel"按钮
   - 选择"新建Excel文件"或"选择现有Excel文件"
   - 程序将所有数据批量写入Excel文件
   - 导出成功后可选择清空数据列表

## 功能特点

### Excel文件结构
生成的Excel文件包含以下列：
- **序号**：自动生成的序号
- **厂家名称**：用户输入的厂家名称
- **TID**：设备标识符
- **标签号**：设备标签号
- **图片**：嵌入的实际图片（非文件路径）
- **记录时间**：数据保存的时间戳

### 图片处理
- 支持常见图片格式：PNG、JPG、JPEG、GIF、BMP
- 自动调整图片大小以适应Excel单元格
- 图片以对象形式嵌入Excel，不依赖外部文件

### 预留功能
- **TID自动获取**：预留了自动获取TID的按钮（暂未实现）
- **标签号自动获取**：预留了自动获取标签号的按钮（暂未实现）

## 注意事项

### 使用前准备
1. 确保已安装Python 3.7或更高版本
2. 确保已安装所需依赖包（openpyxl、Pillow）
3. 准备好要记录的图片文件

### 使用中注意
1. **文件权限**：确保对目标Excel文件有写入权限
2. **文件占用**：保存数据时确保Excel文件未被其他程序打开
3. **数据验证**：所有字段都是必填的，保存前会进行验证
4. **图片大小**：程序会自动调整图片大小，无需手动处理

### 故障排除
1. **程序无法启动**：
   - 检查Python是否正确安装
   - 检查依赖包是否安装完整

2. **无法保存数据**：
   - 检查Excel文件是否被其他程序占用
   - 检查文件路径是否有效
   - 确保所有必填字段都已填写

3. **图片无法显示**：
   - 检查图片文件格式是否支持
   - 检查图片文件是否损坏

## 示例操作

### 使用示例图片测试
程序包含一个示例图片 `images/sample_device.png`，可以用于测试：

1. 启动程序
2. 新建或选择Excel文件
3. 填写测试数据：
   - 厂家名称：示例厂家
   - TID：SAMPLE123456
   - 标签号：LABEL001
4. 选择 `images/sample_device.png` 图片
5. 点击保存数据

### 批量录入建议
1. 准备好所有要录入的图片文件
2. 建议将图片文件命名规范化，便于识别
3. 可以保持程序打开，连续录入多条数据
4. 每次保存后选择清空输入框，便于输入下一条数据

## SVG Logo裁剪工具

程序提供了灵活的SVG logo裁剪工具，可以自定义裁剪区域：

### 使用方法

#### 1. 批处理工具（推荐）
双击 `裁剪SVG工具.bat` 文件，选择预设或自定义裁剪区域。

#### 2. 命令行工具
```bash
# 基本用法
python crop_svg_simple.py [左] [上] [右] [下]

# 示例
python crop_svg_simple.py 0 0 30 100  # 保留左侧30%
python crop_svg_simple.py 25 25 75 75  # 保留中心区域
```

#### 3. 交互式工具
```bash
python crop_svg_logo.py
```

### 裁剪参数说明
- **左边界**: 0-100，表示从左侧开始的百分比位置
- **上边界**: 0-100，表示从顶部开始的百分比位置
- **右边界**: 0-100，表示到右侧结束的百分比位置
- **下边界**: 0-100，表示到底部结束的百分比位置

### 常用预设
- 保留左侧30%: `0 0 30 100`
- 保留左侧50%: `0 0 50 100`
- 保留右侧50%: `50 0 100 100`
- 保留上半部分: `0 0 100 50`
- 保留中心区域: `25 25 75 75`

### 注意事项
1. 原始SVG文件会自动备份为 `logo_original.svg`
2. 裁剪后的文件会替换原始的 `logo.svg`
3. 参数必须满足：左 < 右，上 < 下，且都在0-100范围内

## 技术支持

如遇到问题，请检查：
1. Python版本是否符合要求
2. 依赖包是否正确安装
3. 文件权限是否正确
4. 图片文件是否有效

更多技术细节请参考 `README.md` 文件。
