# RFID超时异常处理功能说明

## 功能概述

在RFID读取过程中，有时会出现通信超时的情况，导致接收到大量重复的数据帧。本次更新实现了当读取到超时数据时，自动抛出异常并在界面上给出明确的超时提示，提高了用户体验和系统稳定性。

## 实现细节

### 1. 新增超时异常类

在`rfid_util.py`中增加了`TimeoutDetectedException`异常类：

```python
class TimeoutDetectedException(Exception):
    """检测到超时数据时抛出的异常，提示可能存在通信问题"""
    pass
```

### 2. 改进超时检测机制

将原来的超时检测逻辑从仅返回空数据改为抛出异常：

```python
# 超时检测
if resp and self._is_timeout_response(resp):
    print(f'[RECV] <检测到超时响应，抛出异常>')
    raise TimeoutDetectedException("RFID通信超时：检测到重复数据帧，可能存在通信问题")
```

### 3. 异常捕获与处理

在`data_recorder.py`中对超时异常进行捕获和处理：

- 在自动TID读取中捕获并处理超时异常
- 在手动TID读取中捕获并处理超时异常
- 添加`_show_timeout_warning`方法在全局状态栏显示超时提示

## 用户体验改进

1. **超时反馈更明确**：通过全局状态栏以红色文字显示超时提示，让用户直观了解问题
2. **配置状态更新**：在配置状态区域也会显示超时提示
3. **错误处理更完善**：超时情况下会自动中断操作，避免程序进入不可控状态

## 使用注意

当看到超时提示时，用户可以尝试以下操作：

1. 检查RFID设备连接是否正常
2. 尝试重新连接RFID设备
3. 如果频繁出现超时，可能需要检查串口设置或硬件问题

## 技术实现

超时检测主要通过两种方式实现：
1. 检测数据中是否包含已知的超时模式并重复出现
2. 检测数据长度是否异常（超过500字节）

这种机制可以有效识别大多数超时情况，提高系统稳定性。
