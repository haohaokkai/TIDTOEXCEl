# 数据记录软件

一个用于记录厂家名称、TID、标签号和图片到Excel文件的Python应用程序。

## 功能特点

- **图形用户界面**：基于tkinter的简洁易用界面
- **Excel文件管理**：支持新建或选择现有Excel文件
- **数据记录**：记录厂家名称、TID、标签号和图片
- **图片嵌入**：将实际图片内容嵌入Excel文件（非文件路径）
- **图片预览**：选择图片后可实时预览
- **自动获取接口**：为TID和标签号预留自动获取功能接口

## 安装要求

### Python版本
- Python 3.7 或更高版本

### 依赖包
```bash
pip install -r requirements.txt
```

或手动安装：
```bash
pip install openpyxl>=3.1.0 Pillow>=9.0.0
```

## 使用方法

### 1. 启动程序
```bash
python data_recorder.py
```

### 2. Excel文件管理
- **新建Excel文件**：点击"新建Excel文件"按钮，选择保存位置和文件名
- **选择现有文件**：点击"选择现有Excel文件"按钮，选择要操作的Excel文件
- 当前操作的文件路径会显示在界面上

### 3. 数据输入
- **厂家名称**：手动输入厂家名称
- **TID**：手动输入TID（自动获取功能暂未实现）
- **标签号**：手动输入标签号（自动获取功能暂未实现）
- **图片**：点击"选择图片"按钮选择图片文件，支持PNG、JPG、JPEG、GIF、BMP格式

### 4. 保存数据
- 填写完所有必填字段后，点击"保存数据"按钮
- 数据将被写入Excel文件的下一行
- 图片会以实际图片对象形式嵌入Excel文件
- 保存成功后可选择是否清空输入框

## Excel文件结构

生成的Excel文件包含以下列：
1. **序号**：自动生成的序号
2. **厂家名称**：用户输入的厂家名称
3. **TID**：设备标识符
4. **标签号**：设备标签号
5. **图片**：嵌入的实际图片
6. **记录时间**：数据保存的时间戳

## 注意事项

1. **图片格式**：支持常见的图片格式（PNG、JPG、JPEG、GIF、BMP）
2. **图片大小**：程序会自动调整图片大小以适应Excel单元格显示
3. **文件保存**：确保对目标Excel文件有写入权限
4. **数据验证**：所有字段都是必填的，保存前会进行验证

## 预留功能

- **TID自动获取**：预留了自动获取TID的接口，可根据具体设备接口进行扩展
- **标签号自动获取**：预留了自动获取标签号的接口，可根据具体需求进行扩展

## 技术实现

- **GUI框架**：tkinter
- **Excel处理**：openpyxl
- **图片处理**：PIL/Pillow
- **图片嵌入**：使用openpyxl的Image功能将图片作为对象嵌入Excel

## 故障排除

### 常见问题

1. **无法打开Excel文件**
   - 确保文件未被其他程序占用
   - 检查文件权限

2. **图片无法显示**
   - 确保图片文件格式受支持
   - 检查图片文件是否损坏

3. **程序启动失败**
   - 确保已安装所有依赖包
   - 检查Python版本是否符合要求

## 开发扩展

如需扩展自动获取功能，可以修改以下方法：
- `auto_get_tid()`: 实现TID自动获取逻辑
- `auto_get_label()`: 实现标签号自动获取逻辑
