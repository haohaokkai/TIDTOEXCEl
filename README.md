# TIDtoExcel - RFID数据记录系统

一个基于Python和Tkinter的RFID数据记录系统，支持自动读取RFID标签TID、OCR识别标签号、摄像头图片捕获，并将数据批量导出到Excel文件。

## 功能特点

### 核心功能
- 🏷️ **RFID标签读取**：自动读取RFID标签的TID（设备标识符）
- 🔍 **OCR标签识别**：通过摄像头自动识别7位标签号
- 📷 **图片管理**：支持手动选择图片或摄像头自动捕获
- 📊 **Excel导出**：批量导出数据到Excel文件，图片直接嵌入
- 🔄 **自动化流程**：一键启动自动获取模式，持续监控标签变化

### 技术特性
- **硬件配置管理**：自动检测并配置RFID设备和摄像头
- **数据去重**：自动检测重复数据，避免重复录入
- **实时预览**：图片实时预览和摄像头画面显示
- **批量操作**：支持数据列表的批量管理和导出
- **配置持久化**：设备配置自动保存，下次启动自动加载

## 系统要求

- **操作系统**：Windows 10/11
- **Python版本**：3.7+
- **硬件要求**：
  - RFID读写器（串口连接）
  - USB摄像头（用于OCR识别和图片捕获）

## 快速安装

### 1. 克隆项目
```bash
git clone <repository-url>
cd TIDtoExcel
```

### 2. 安装依赖
```bash
# 完整安装（推荐）
pip install -r requirements.txt

# 或最小化安装
pip install -r requirements_minimal.txt
```

### 3. 启动程序
```bash
# 方式1：直接运行Python脚本
python data_recorder.py

# 方式2：使用批处理文件（Windows）
双击 "启动数据记录软件.bat"
```

## 使用指南

### 第一步：设备配置
1. **RFID端口配置**
   - 从下拉列表选择RFID设备串口
   - 点击"刷新"重新检测可用串口
   - 配置自动保存到 `config/config.json`

2. **摄像头配置**
   - 选择要使用的摄像头设备
   - 支持多摄像头切换
   - 实时显示摄像头状态

### 第二步：数据录入
1. **厂家名称**：输入设备厂家名称（必填）
2. **图片选择**：
   - 手动选择：点击"选择图片"按钮
   - 自动捕获：使用摄像头实时捕获
   - 支持格式：PNG、JPG、JPEG、GIF、BMP

### 第三步：自动获取模式
1. 点击"开始自动获取"按钮
2. 系统自动执行以下流程：
   - 读取RFID标签TID（连续5次验证）
   - OCR识别7位标签号
   - 自动捕获摄像头图片
   - 数据去重并添加到列表
3. 更换标签后自动获取新数据
4. 点击"停止自动获取"结束流程

### 第四步：数据导出
1. **查看数据**：所有数据显示在列表中
2. **批量操作**：
   - 清空列表：删除所有数据
   - 删除选中：删除指定数据行
   - 编辑数据：双击数据行进行编辑
3. **导出Excel**：
   - 新建Excel文件或选择现有文件
   - 批量写入所有数据
   - 图片直接嵌入Excel单元格

## 项目结构

```
TIDtoExcel/
├── data_recorder.py          # 主程序文件
├── rfid_util.py             # RFID工具类
├── camera.py                # 摄像头和OCR功能
├── crop_svg_logo.py         # SVG Logo裁剪工具
├── config/
│   ├── config_manager.py    # 配置管理器
│   └── config.json          # 配置文件
├── images/                  # 图片资源
├── demo_output/             # 演示输出
├── test_output/             # 测试输出
├── requirements.txt         # 完整依赖列表
├── requirements_minimal.txt # 最小依赖列表
└── 使用说明.md              # 详细使用说明
```

## Excel输出格式

生成的Excel文件包含以下列：
- **序号**：自动生成的序号
- **厂家名称**：用户输入的厂家名称
- **TID**：RFID标签的设备标识符
- **标签号**：OCR识别的7位标签号
- **图片**：嵌入的实际图片对象
- **记录时间**：数据保存的时间戳

## 附加工具

### SVG Logo裁剪工具
提供灵活的SVG logo裁剪功能：

```bash
# 批处理工具（推荐）
双击 "裁剪SVG工具.bat"

# 命令行工具
python crop_svg_simple.py [左] [上] [右] [下]

# 交互式工具
python crop_svg_logo.py
```

**常用预设**：
- 保留左侧30%: `0 0 30 100`
- 保留中心区域: `25 25 75 75`
- 保留上半部分: `0 0 100 50`

## 故障排除

### 常见问题

1. **程序无法启动**
   - 检查Python版本（需要3.7+）
   - 安装缺失的依赖包
   - 检查系统权限

2. **RFID设备无法连接**
   - 确认设备正确连接
   - 检查串口驱动程序
   - 尝试不同的串口设置

3. **摄像头无法工作**
   - 检查摄像头权限设置
   - 确认摄像头未被其他程序占用
   - 尝试切换不同的摄像头

4. **Excel导出失败**
   - 确保Excel文件未被占用
   - 检查文件写入权限
   - 验证所有必填字段已填写

### 日志和调试
- 程序运行时会在控制台输出详细日志
- 配置文件位于 `config/config.json`
- 临时图片文件自动清理

## 开发信息

### 技术栈
- **GUI框架**：Tkinter
- **Excel处理**：openpyxl
- **图像处理**：Pillow (PIL)
- **串口通信**：pyserial
- **OCR识别**：easyocr
- **摄像头**：opencv-python

### 配置管理
系统使用JSON格式保存配置：
```json
{
  "rfid_port": "COM3",
  "camera_index": 0,
  "ocr_count": 10,
  "tid_count": 5
}
```

## 许可证

本项目采用开源许可证，详情请查看LICENSE文件。

## 贡献

欢迎提交Issue和Pull Request来改进项目。

## 联系方式

如有问题或建议，请通过以下方式联系：
- 提交GitHub Issue
- 发送邮件至项目维护者

---

**注意**：使用前请确保已正确安装所有依赖包，并连接好RFID设备和摄像头。详细操作说明请参考 `使用说明.md` 文件。