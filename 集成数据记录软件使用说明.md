# 集成数据记录软件使用说明

## 概述

集成数据记录软件将RFID TID读取、OCR标签识别和摄像头图片捕获功能整合到一个统一的界面中，提供完整的数据记录解决方案。

## 功能特点

### 🎯 **核心功能**
- **自动TID读取**: 使用RFID设备自动读取标签TID
- **自动标签号识别**: 使用OCR技术自动识别6位数字标签号
- **摄像头图片捕获**: 实时预览并捕获图片
- **Excel数据存储**: 将数据和图片保存到Excel文件

### 🔧 **技术特性**
- **稳定读取**: TID需要连续读取5次相同值才确认
- **准确识别**: 标签号需要连续识别5次相同值才确认
- **实时预览**: 摄像头实时预览和OCR识别结果显示
- **图片存储**: 图片以对象形式存储在Excel中，非文件路径

## 界面布局

### 左侧面板
- **硬件配置区域**: RFID端口和摄像头选择
- **数据输入区域**:
  - 厂家名称（手动输入，保持不变）
  - TID（手动输入或自动获取）
  - 标签号（手动输入或自动获取）
  - 图片（文件选择或摄像头捕获）
  - 保存数据和清空输入按钮
- **数据列表区域**: 显示已录入的数据

### 右侧面板
- **摄像头预览**: 实时显示摄像头画面
- **图片预览**: 显示选择或捕获的图片
- **OCR识别结果**: 显示实时OCR识别状态

## 使用流程

### 1. 环境准备
```bash
# 安装依赖包
pip install opencv-python easyocr pillow openpyxl tkinter

# 连接硬件设备
- 连接RFID读卡器到串口
- 连接USB摄像头
```

### 2. 启动软件
```bash
python data_recorder.py
```

### 3. 初始化检查
软件启动时会自动检查：
- ✅ OCR引擎初始化
- ✅ RFID设备连接
- ✅ 摄像头设备检测

### 4. 数据记录流程

#### **步骤1: 硬件配置**
- 选择正确的RFID端口
- 选择正确的摄像头设备
- 确认配置状态显示正常

#### **步骤2: 输入厂家名称**
- 手动输入厂家名称（此信息会保持不变，便于批量录入）

#### **步骤3: 获取TID**
- **手动输入**: 直接在TID输入框中输入
- **自动获取**: 点击TID旁的"自动获取"按钮，将RFID标签靠近读卡器

#### **步骤4: 获取标签号**
- **手动输入**: 直接在标签号输入框中输入
- **自动获取**:
  1. 点击"启动摄像头"开始预览
  2. 将6位数字标签对准摄像头
  3. 点击标签号旁的"自动获取"按钮开始识别

#### **步骤5: 获取图片**
- **文件选择**: 点击"选择图片"从文件中选择
- **摄像头捕获**:
  1. 确保摄像头预览已启动
  2. 调整拍摄角度
  3. 点击"摄像头捕获"按钮

#### **步骤6: 保存数据**
- 点击"保存数据"按钮将当前数据添加到列表
- 系统会自动清空TID和标签号输入框（保留厂家名称）
- 继续录入下一条数据

#### **步骤7: 导出数据**
- 录入完成后，点击"导出到Excel"按钮
- 选择保存位置和文件名
- 系统会将所有数据和图片保存到Excel文件

## 自动功能详解

### 🎯 **自动TID读取**
- **工作模式**: 应答模式
- **验证机制**: 连续读取5次相同TID
- **超时时间**: 15秒
- **状态显示**: 实时显示读取进度

### 🔍 **自动标签号识别**
- **识别目标**: 6位数字
- **验证机制**: 连续识别5次相同结果
- **最大尝试**: 50次尝试
- **状态显示**: 实时显示识别进度和结果

### 📷 **摄像头功能**
- **预览分辨率**: 400x300像素
- **捕获分辨率**: 原始分辨率
- **帧率**: 约30fps
- **图片格式**: PNG格式

## 错误处理

### 常见问题及解决方案

#### **RFID设备连接失败**
- 检查串口连接
- 确认设备驱动已安装
- 检查串口号配置

#### **摄像头不可用**
- 检查USB连接
- 确认摄像头驱动已安装
- 检查是否被其他程序占用

#### **OCR识别失败**
- 确保标签清晰可见
- 调整光线条件
- 检查标签是否为6位数字

#### **Excel保存失败**
- 检查文件是否被其他程序打开
- 确认有写入权限
- 检查磁盘空间

## 技术规格

### 硬件要求
- **操作系统**: Windows 10/11
- **内存**: 4GB以上
- **摄像头**: USB摄像头
- **RFID设备**: 支持串口通信的RFID读卡器

### 软件依赖
- **Python**: 3.7+
- **OpenCV**: 4.0+
- **EasyOCR**: 1.6+
- **PIL**: 8.0+
- **openpyxl**: 3.0+

### 性能指标
- **TID读取时间**: 通常3-10秒
- **OCR识别时间**: 通常5-15秒
- **图片捕获时间**: 瞬时
- **数据保存时间**: 1-3秒

## 测试工具

### 运行集成测试
```bash
python test_integrated_recorder.py
```

测试内容包括：
- 模块导入测试
- 硬件可用性测试
- 应用初始化测试
- 功能可用性测试

## 输入框行为说明

### 🔄 **自动获取行为**
- **TID自动获取**: 清空当前TID输入框 → 显示"正在读取TID..." → 更新为读取结果
- **标签号自动获取**: 清空当前标签号输入框 → 显示"正在识别标签号..." → 更新为识别结果
- **厂家名称**: 始终保持不变，便于批量录入同一厂家的产品

### 💾 **保存数据行为**
- 点击"保存数据"后，系统会：
  1. 验证必填字段（厂家名称、TID或标签号至少一个）
  2. 将数据添加到列表
  3. **保留厂家名称**（便于连续录入）
  4. **清空TID和标签号输入框**（准备录入下一条）
  5. 清空图片选择

### 🧹 **清空输入行为**
- 点击"清空输入"按钮会：
  1. **保留厂家名称**
  2. 清空TID输入框
  3. 清空标签号输入框
  4. 清空图片选择
  5. 重置OCR识别结果显示

## 注意事项

1. **设备连接**: 确保所有硬件设备在软件启动前已正确连接
2. **厂家名称**: 每次启动软件后需要输入一次，之后会自动保持
3. **批量录入**: 适合录入同一厂家的多个产品，只需重复输入TID/标签号
4. **资源管理**: 程序退出时会自动清理所有资源
5. **数据备份**: 建议定期备份Excel数据文件
6. **环境光线**: OCR识别需要良好的光线条件
7. **标签距离**: RFID读取需要标签在有效范围内

## 更新日志

### v1.0.0 (当前版本)
- ✅ 集成RFID TID读取功能
- ✅ 集成OCR标签号识别功能
- ✅ 集成摄像头图片捕获功能
- ✅ 统一的用户界面
- ✅ Excel数据存储功能
- ✅ 实时预览和状态显示
- ✅ 完整的错误处理机制

## 技术支持

如遇到问题，请检查：
1. 硬件连接状态
2. 驱动程序安装
3. 依赖包版本
4. 系统兼容性

---

**开发团队**: TID数据记录项目组  
**最后更新**: 2024年8月  
**版本**: v1.0.0
